<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>CVMaker</title>
		<link rel="stylesheet" href="./dist/css/register.min.css" />
		<script
			src="https://kit.fontawesome.com/11fe5cd726.js"
			crossorigin="anonymous"></script>
	</head>
	<body>
		<nav class="nav__blog">
			<div class="nav__logo">
				<a href="index.html" class="nav__logo-text"
					><img
						src="./dist/img/logo.svg"
						alt="Logo"
						class="nav__logo-img" />Creator<span>CV</span>
				</a>
			</div>
		</nav>
		<hr />

		<main class="reset">
			<div class="wrapper">
				<div class="form-box" id="new-password-form">
					<h2 class="form-heading">WPROWADZ NOWE HASŁO</h2>
					<p class="form-info">Zresetuj swoje hasło w minutę!</p>
					<form>
						<div class="form-group">
							<label for="new-password" class="form-group-label">Hasło</label>
							<input
								type="password"
								id="new-password"
								name="password"
								placeholder="Nowe hasło"
								class="form-group-input" />
							<i class="fa fa-lock"></i>
						</div>

						<button type="submit" class="btn-primary reset-btn">
							Zmień hasło
						</button>
					</form>
					<div class="message">
						<p class="success"></p>
						<p class="error"></p>
					</div>
				</div>
			</div>
		</main>
		<footer class="footer">
			<hr />
			<div class="footer__desktop">
				<div class="footer__desktop-box">
					<div class="footer__logo">
						<a href="#" class="footer__logo-text"
							><img
								src="./dist/img/logo.svg"
								alt="Logo"
								class="footer__logo-img" />Creator<span>CV</span>
						</a>
					</div>
					<div class="footer-links">
						<ul class="footer__desktop-list footer-list">
							<li class="footer__desktop-item footer-item">
								<a href="#">Kreator</a>
							</li>
							<li class="footer__desktop-item footer-item">
								<a href="#">Blog</a>
							</li>
							<li class="footer__desktop-item footer-item">
								<a href="#">FAQ</a>
							</li>
							<li class="footer__desktop-item footer-item">
								<a href="#">Kontakt</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="footer__desktop__bottom-box">
					<div class="footer__desktop-social-media-box">
						<a href="#"
							><img src="./dist/img/instagram.svg" alt="instagram"
						/></a>
						<a href="#"><img src="./dist/img/fb.svg" alt="facebook" /></a>
						<a href="#"><img src="./dist/img/twitter.svg" alt="facebook" /></a>
					</div>

					<div>
						<p class="footer__desktop-copyright">
							&copy; 2021 Creator CV. Wszelkie prawa zastrzeżone.
						</p>
					</div>
				</div>
			</div>
			<div class="footer--mobile">
				<div class="footer--mobile-box">
					<div class="footer__logo">
						<a href="#" class="footer__logo-text"
							><img
								src="./dist/img/logo.svg"
								alt="Logo"
								class="footer__logo-img" />Creator<span>CV</span>
						</a>
					</div>
					<div class="footer--mobile-social-media-box">
						<a href="#"
							><img src="./dist/img/instagram.svg" w alt="instagram"
						/></a>
						<a href="#"><img src="./dist/img/fb.svg" alt="facebook" /></a>
						<a href="#"><img src="./dist/img/twitter.svg" alt="facebook" /></a>
					</div>
				</div>
				<p class="footer--mobile-copyright">
					&copy; 2024 Creator CV. Wszelkie prawa zastrzeżone.
				</p>
			</div>
		</footer>
		<script>
			document
				.getElementById('new-password-form')
				.addEventListener('submit', async function (event) {
					event.preventDefault();

					const urlParams = new URLSearchParams(window.location.search);
					const token = urlParams.get('token');
					const newPassword = document.getElementById('new-password').value;

					const response = await fetch(
						'http://localhost:8080/api/users/change-password',
						{
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
							},
							body: JSON.stringify({
								token: token,
								newPassword: newPassword,
							}),
						}
					);

					const result = await response.text();
					const messageElement = document.querySelector('.message');
					const successElement = messageElement.querySelector('.success');
					const errorElement = messageElement.querySelector('.error');

					if (response.ok) {
						successElement.textContent = result;
						errorElement.textContent = '';
					} else {
						successElement.textContent = '';
						errorElement.textContent = result;
					}
				});
		</script>
		<script src="./dist/js/session.min.js"></script>
		<!-- <script src="dist/js/main.min.js"></script> -->
	</body>
</html>
