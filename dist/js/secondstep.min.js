function updatePreview(e){var t=e.target.id,e=e.target.value,t=document.getElementById("preview-"+t);t&&(t.querySelector("p").innerHTML=e)}function insertTag(e){var t,n,o,r,a=document.querySelector("textarea:focus");a&&(t=a.selectionStart,r=a.selectionEnd,o=(n=a.value).substring(0,t),r=n.substring(r,n.length),a.value=o+e+r,a.selectionStart=a.selectionEnd=t+e.length/2,a.focus(),updatePreview({target:a}))}var inputs=document.querySelectorAll("input, textarea"),uploadedPhoto=(inputs.forEach(function(e){e.addEventListener("input",updatePreview)}),document.querySelector(".btn-bold").addEventListener("click",function(){return insertTag("<b></b>")}),document.querySelector(".btn-strike-through").addEventListener("click",function(){return insertTag("<s></s>")}),document.querySelector(".btn-underline").addEventListener("click",function(){return insertTag("<u></u>")}),document.querySelector(".btn-list").addEventListener("click",function(){return insertTag("<ul><li></li></ul>")}),document.querySelector(".btn-ordered-list").addEventListener("click",function(){return insertTag("<ol><li></li></ol>")}),null);function getParameterByName(e){return new URLSearchParams(window.location.search).get(e)}document.getElementById("photo-upload").addEventListener("change",function(e){var t,e=e.target.files[0];e&&(uploadedPhoto=e,(t=new FileReader).onload=function(e){document.getElementById("preview-photo").innerHTML='<img src="'.concat(e.target.result,'" alt="Photo" style="max-width: 150px; max-height: 150px; margin-bottom: 20px; border-radius: 50%; overflow: hidden;">')},t.readAsDataURL(e))}),document.addEventListener("DOMContentLoaded",function(){var e,t=getParameterByName("image");t?(e=document.getElementById("cv-preview"))?(e.style.backgroundImage="url(".concat(decodeURIComponent(t),")"),e.style.backgroundSize="cover",e.style.backgroundPosition="center"):console.error('Element o ID "cv-preview" nie został znaleziony.'):console.error('Parametr "image" nie został znaleziony w URL.'),document.getElementById("save-cv").addEventListener("click",function(e){e.preventDefault(),console.log("Kliknięcie zarejestrowane!");var e=document.getElementById("cv-preview").outerHTML,t=(console.log("Pobrany HTML:",e),new FormData);t.append("cvContent",new Blob([e],{type:"text/html"})),t.append("userId",sessionStorage.getItem("userId")),uploadedPhoto&&t.append("photo",uploadedPhoto),console.log("Rozpoczynanie fetch..."),fetch("http://localhost:8080/api/cvfile/uploadPdf",{method:"POST",body:t}).then(function(e){return console.log("Fetch zakończony. Status odpowiedzi:",e.status),e.ok?e.text():(console.error("Fetch error:",e),e.text().then(function(e){throw new Error(e)}))}).then(function(e){console.log("Odpowiedź serwera:",e);try{var t=JSON.parse(e);t.cvFileId&&(sessionStorage.setItem("cvFileId",t.cvFileId),console.log("cvFileId zapisany w sessionStorage:",t.cvFileId))}catch(e){console.error("Błąd parsowania odpowiedzi:",e)}alert("CV saved successfully!"),window.location.href="thirdstep.html"}).catch(function(e){console.error("Błąd podczas przetwarzania odpowiedzi:",e),alert("Wystąpił błąd podczas zapisywania CV: "+e.message)})})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlY29uZHN0ZXAuanMiXSwibmFtZXMiOlsidXBkYXRlUHJldmlldyIsImV2ZW50IiwiaW5wdXRJZCIsInRhcmdldCIsImlkIiwiaW5wdXRWYWx1ZSIsInZhbHVlIiwiZ2V0RWxlbWVudEJ5SWQiLCJwcmV2aWV3RWxlbWVudCIsImlubmVySFRNTCIsImluc2VydFRhZyIsInRhZyIsInRleHRhcmVhIiwiZW5kIiwidGV4dCIsImJlZm9yZSIsInF1ZXJ5U2VsZWN0b3IiLCJzZWxlY3Rpb25TdGFydCIsInN0YXJ0Iiwic2VsZWN0aW9uRW5kIiwic3Vic3RyaW5nIiwibGVuZ3RoIiwiYWZ0ZXIiLCJmb2N1cyIsImlucHV0cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInVwbG9hZGVkUGhvdG8iLCJmb3JFYWNoIiwiaW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwibmFtZSIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiZ2V0IiwiZmlsZSIsImZpbGVzIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsInByZXZpZXdQaG90byIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJjdlByZXZpZXdFbGVtZW50IiwiaW1hZ2VVcmwiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImNvbmNhdCIsImRlY29kZVVSSUNvbXBvbmVudCIsImJhY2tncm91bmRTaXplIiwiY29uc29sZSIsImVycm9yIiwicHJldmVudERlZmF1bHQiLCJjdkNvbnRlbnQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwib3V0ZXJIVE1MIiwiYXBwZW5kIiwiQmxvYiIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsInR5cGUiLCJtZXRob2QiLCJsb2ciLCJ0aGVuIiwicmVzcG9uc2UiLCJFcnJvciIsImVycm9yVGV4dCIsInN0YXR1cyIsIm9rIiwiY3ZGaWxlSWQiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwic2V0SXRl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Q0wsQ0FBQyIsImZpbGUiOiJzZWNvbmRzdGVwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgQ1YgcHJldmlldyBpbiByZWFsLXRpbWVcclxuZnVuY3Rpb24gdXBkYXRlUHJldmlldyhldmVudCkge1xyXG5cdGNvbnN0IGlucHV0SWQgPSBldmVudC50YXJnZXQuaWQ7XHJcblx0Y29uc3QgaW5wdXRWYWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuXHRjb25zdCBwcmV2aWV3RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aWV3LScgKyBpbnB1dElkKTtcclxuXHJcblx0aWYgKHByZXZpZXdFbGVtZW50KSB7XHJcblx0XHRwcmV2aWV3RWxlbWVudC5xdWVyeVNlbGVjdG9yKCdwJykuaW5uZXJIVE1MID0gaW5wdXRWYWx1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGluc2VydCBIVE1MIHRhZ3MgYXQgdGhlIGN1cnNvciBwb3NpdGlvbiBpbiB0aGUgdGV4dGFyZWFcclxuZnVuY3Rpb24gaW5zZXJ0VGFnKHRhZykge1xyXG5cdGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGV4dGFyZWE6Zm9jdXMnKTtcclxuXHRpZiAodGV4dGFyZWEpIHtcclxuXHRcdGNvbnN0IHN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQ7XHJcblx0XHRjb25zdCBlbmQgPSB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQ7XHJcblx0XHRjb25zdCB0ZXh0ID0gdGV4dGFyZWEudmFsdWU7XHJcblx0XHRjb25zdCBiZWZvcmUgPSB0ZXh0LnN1YnN0cmluZygwLCBzdGFydCk7XHJcblx0XHRjb25zdCBhZnRlciA9IHRleHQuc3Vic3RyaW5nKGVuZCwgdGV4dC5sZW5ndGgpO1xyXG5cdFx0dGV4dGFyZWEudmFsdWUgPSBiZWZvcmUgKyB0YWcgKyBhZnRlcjtcclxuXHRcdHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID0gdGV4dGFyZWEuc2VsZWN0aW9uRW5kID0gc3RhcnQgKyB0YWcubGVuZ3RoIC8gMjtcclxuXHRcdHRleHRhcmVhLmZvY3VzKCk7XHJcblx0XHR1cGRhdGVQcmV2aWV3KHsgdGFyZ2V0OiB0ZXh0YXJlYSB9KTsgLy8gVXBkYXRlIHByZXZpZXcgYWZ0ZXIgaW5zZXJ0aW5nIHRhZ1xyXG5cdH1cclxufVxyXG5cclxuLy8gQXR0YWNoIGV2ZW50IGxpc3RlbmVycyB0byBhbGwgaW5wdXQgYW5kIHRleHRhcmVhIGVsZW1lbnRzXHJcbmNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0LCB0ZXh0YXJlYScpO1xyXG5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuXHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZVByZXZpZXcpO1xyXG59KTtcclxuXHJcbi8vIEF0dGFjaCBldmVudCBsaXN0ZW5lcnMgdG8gZm9ybWF0dGluZyBidXR0b25zXHJcbmRvY3VtZW50XHJcblx0LnF1ZXJ5U2VsZWN0b3IoJy5idG4tYm9sZCcpXHJcblx0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaW5zZXJ0VGFnKCc8Yj48L2I+JykpO1xyXG5kb2N1bWVudFxyXG5cdC5xdWVyeVNlbGVjdG9yKCcuYnRuLXN0cmlrZS10aHJvdWdoJylcclxuXHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBpbnNlcnRUYWcoJzxzPjwvcz4nKSk7XHJcbmRvY3VtZW50XHJcblx0LnF1ZXJ5U2VsZWN0b3IoJy5idG4tdW5kZXJsaW5lJylcclxuXHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBpbnNlcnRUYWcoJzx1PjwvdT4nKSk7XHJcbmRvY3VtZW50XHJcblx0LnF1ZXJ5U2VsZWN0b3IoJy5idG4tbGlzdCcpXHJcblx0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaW5zZXJ0VGFnKCc8dWw+PGxpPjwvbGk+PC91bD4nKSk7XHJcbmRvY3VtZW50XHJcblx0LnF1ZXJ5U2VsZWN0b3IoJy5idG4tb3JkZXJlZC1saXN0JylcclxuXHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBpbnNlcnRUYWcoJzxvbD48bGk+PC9saT48L29sPicpKTtcclxuXHJcbi8vIEhhbmRsZSBpbWFnZSB1cGxvYWRcclxubGV0IHVwbG9hZGVkUGhvdG8gPSBudWxsOyAvLyBabWllbm5hIGRvIHByemVjaG93eXdhbmlhIHBsaWt1IHpkasSZY2lhXHJcbmRvY3VtZW50XHJcblx0LmdldEVsZW1lbnRCeUlkKCdwaG90by11cGxvYWQnKVxyXG5cdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07XHJcblx0XHRpZiAoZmlsZSkge1xyXG5cdFx0XHR1cGxvYWRlZFBob3RvID0gZmlsZTsgLy8gUHJ6ZWNob3dhaiBwcnplc8WCYW5lIHpkasSZY2llXHJcblx0XHRcdGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblx0XHRcdHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRcdGNvbnN0IHByZXZpZXdQaG90byA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aWV3LXBob3RvJyk7XHJcblx0XHRcdFx0cHJldmlld1Bob3RvLmlubmVySFRNTCA9IGA8aW1nIHNyYz1cIiR7ZS50YXJnZXQucmVzdWx0fVwiIGFsdD1cIlBob3RvXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDE1MHB4OyBtYXgtaGVpZ2h0OiAxNTBweDsgbWFyZ2luLWJvdHRvbTogMjBweDsgYm9yZGVyLXJhZGl1czogNTAlOyBvdmVyZmxvdzogaGlkZGVuO1wiPmA7XHJcblx0XHRcdH07XHJcblx0XHRcdHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuLy8gT24gZG9jdW1lbnQgbG9hZCwgaGFuZGxlIGltYWdlIFVSTCBmb3IgYmFja2dyb3VuZFxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xyXG4gICAgY29uc3QgaW1hZ2VVcmwgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2ltYWdlJyk7XHJcbiAgICBpZiAoaW1hZ2VVcmwpIHtcclxuICAgICAgICBjb25zdCBjdlByZXZpZXdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N2LXByZXZpZXcnKTtcclxuICAgICAgICBpZiAoY3ZQcmV2aWV3RWxlbWVudCkge1xyXG4gICAgICAgICAgICBjdlByZXZpZXdFbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtkZWNvZGVVUklDb21wb25lbnQoaW1hZ2VVcmwpfSlgO1xyXG4gICAgICAgICAgICBjdlByZXZpZXdFbGVtZW50LnN0eWxlLmJhY2tncm91bmRTaXplID0gJ2NvdmVyJztcclxuICAgICAgICAgICAgY3ZQcmV2aWV3RWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSAnY2VudGVyJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbGVtZW50IG8gSUQgXCJjdi1wcmV2aWV3XCIgbmllIHpvc3RhxYIgem5hbGV6aW9ueS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1BhcmFtZXRyIFwiaW1hZ2VcIiBuaWUgem9zdGHFgiB6bmFsZXppb255IHcgVVJMLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlLWN2JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnS2xpa25pxJljaWUgemFyZWplc3Ryb3dhbmUhJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGN2Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdi1wcmV2aWV3Jykub3V0ZXJIVE1MO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdQb2JyYW55IEhUTUw6JywgY3ZDb250ZW50KTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2N2Q29udGVudCcsIG5ldyBCbG9iKFtjdkNvbnRlbnRdLCB7IHR5cGU6ICd0ZXh0L2h0bWwnIH0pKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VzZXJJZCcsIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpKTsgLy8gVcW8eXdhaiBgZ2V0SXRlbWAgZG8gcG9icmFuaWEgd2FydG/Fm2NpXHJcblxyXG4gICAgICAgIGlmICh1cGxvYWRlZFBob3RvKSB7XHJcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgncGhvdG8nLCB1cGxvYWRlZFBob3RvKTsgLy8gRG9kYW5pZSBwcnplc8WCYW5lZ28gemRqxJljaWEgZG8gRm9ybURhdGFcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdSb3pwb2N6eW5hbmllIGZldGNoLi4uJyk7XHJcblxyXG4gICAgICAgIGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL2N2ZmlsZS91cGxvYWRQZGYnLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBib2R5OiBmb3JtRGF0YSxcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaCB6YWtvxYRjem9ueS4gU3RhdHVzIG9kcG93aWVkemk6JywgcmVzcG9uc2Uuc3RhdHVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmV0Y2ggZXJyb3I6JywgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCkudGhlbigoZXJyb3JUZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7IC8vIFBvYmllcnogb2Rwb3dpZWTFuiBqYWtvIHRla3N0XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnT2Rwb3dpZWTFuiBzZXJ3ZXJhOicsIHRleHQpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFBhcnNvd2FuaWUgb2Rwb3dpZWR6aSBqYWtvIEpTT04sIGplxZtsaSBvZHBvd2llZMW6IGplc3QgdyBmb3JtYWNpZSBKU09OXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRleHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBTcHJhd2TFuiwgY3p5IG9kcG93aWVkxbogemF3aWVyYSBgY3ZGaWxlSWRgIGkgemFwaXN6IGRvIGBzZXNzaW9uU3RvcmFnZWBcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5jdkZpbGVJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdjdkZpbGVJZCcsIGRhdGEuY3ZGaWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY3ZGaWxlSWQgemFwaXNhbnkgdyBzZXNzaW9uU3RvcmFnZTonLCBkYXRhLmN2RmlsZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQsWCxIVkIHBhcnNvd2FuaWEgb2Rwb3dpZWR6aTonLCBlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBhbGVydCgnQ1Ygc2F2ZWQgc3VjY2Vzc2Z1bGx5IScpO1xyXG4gICAgICAgICAgICAgICAgLy8gUG8gemFwaXNhbml1IENWIG5hIHNlcndlcnplLCBwcnpla2llcm93YW5pZSBkbyB0cnplY2llZ28ga3Jva3VcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJ3RoaXJkc3RlcC5odG1sJztcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQsWCxIVkIHBvZGN6YXMgcHJ6ZXR3YXJ6YW5pYSBvZHBvd2llZHppOicsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KCdXeXN0xIVwacWCIGLFgsSFZCBwb2RjemFzIHphcGlzeXdhbmlhIENWOiAnICsgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gZ2V0UGFyYW1ldGVyQnlOYW1lKG5hbWUpIHtcclxuICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICByZXR1cm4gdXJsUGFyYW1zLmdldChuYW1lKTtcclxufVxyXG4iXX0=
